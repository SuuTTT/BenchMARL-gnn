# DeepSets-GNN Combination
# Architecture: DeepSets → GNN GATv2 → MLP[32]
# Permutation-invariant features + Attention-based graph

defaults:
  - layers@layers.l1: deepsets
  - layers@layers.l2: gnn
  - layers@layers.l3: mlp
  - _self_

intermediate_sizes: [64, 32]

layers:
  l1:
    aggr: sum
    out_features_local_nn: 64
    local_nn_num_cells: [64]
    local_nn_activation_class: torch.nn.Tanh
    global_nn_num_cells: [64]
    global_nn_activation_class: torch.nn.Tanh
  l2:
    topology: full
    self_loops: false
    gnn_class: torch_geometric.nn.conv.GATv2Conv
    gnn_kwargs:
      heads: 2
      concat: false
  l3:
    num_cells: [32]
    activation_class: torch.nn.Tanh
    layer_class: torch.nn.Linear
